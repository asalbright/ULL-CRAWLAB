[theta_1_dot, 
theta_2_dot, 
theta_3_dot, 
(-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(-m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot)/2 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3))/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))*(-l_1*l_2*m_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot/2 + l_1*l_2*m_2*np.sin(theta_2)*theta_1_dot*theta_2_dot/2 + m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot)/2 - m_3*(-2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 - (-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) + self.tau_2)/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)) + self.tau_3)/(I_3 + l_3**2*m_3/4 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))**2/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))) - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(-l_1*l_2*m_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot/2 + l_1*l_2*m_2*np.sin(theta_2)*theta_1_dot*theta_2_dot/2 + m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot)/2 - m_3*(-2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))*(-m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot)/2 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3))/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))*(-l_1*l_2*m_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot/2 + l_1*l_2*m_2*np.sin(theta_2)*theta_1_dot*theta_2_dot/2 + m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot)/2 - m_3*(-2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 - (-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) + self.tau_2)/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)) + self.tau_3)/(I_3 + l_3**2*m_3/4 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))**2/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))) - (-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) + self.tau_2)/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)) + self.tau_1)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2), 
(-l_1*l_2*m_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot/2 + l_1*l_2*m_2*np.sin(theta_2)*theta_1_dot*theta_2_dot/2 + m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot)/2 - m_3*(-2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))*(-m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot)/2 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3))/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))*(-l_1*l_2*m_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot/2 + l_1*l_2*m_2*np.sin(theta_2)*theta_1_dot*theta_2_dot/2 + m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot)/2 - m_3*(-2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 - (-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) + self.tau_2)/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)) + self.tau_3)/(I_3 + l_3**2*m_3/4 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))**2/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))) - (-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) + self.tau_2)/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)), 
(-m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot)/2 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3))/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))*(-l_1*l_2*m_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot/2 + l_1*l_2*m_2*np.sin(theta_2)*theta_1_dot*theta_2_dot/2 + m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_1_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3) - np.sin(theta_3)*np.cos(theta_2))*(theta_1_dot + theta_2_dot + theta_3_dot)*theta_1_dot)/2 - m_3*(-2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 - (-m_2*(-l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot)/2 - m_3*(-2*l_1*l_2*(theta_1_dot + theta_2_dot)*np.sin(theta_2)*theta_2_dot - 2*l_1*l_2*np.sin(theta_2)*theta_1_dot*theta_2_dot + l_1*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot) + l_1*l_3*(-np.sin(theta_2)*np.cos(theta_3)*theta_2_dot - np.sin(theta_2)*np.cos(theta_3)*theta_3_dot - np.sin(theta_3)*np.cos(theta_2)*theta_2_dot - np.sin(theta_3)*np.cos(theta_2)*theta_3_dot)*theta_1_dot - l_2*l_3*(theta_1_dot + theta_2_dot)*np.sin(theta_3)*theta_3_dot - l_2*l_3*(theta_1_dot + theta_2_dot + theta_3_dot)*np.sin(theta_3)*theta_3_dot)/2 + self.tau_1)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) + self.tau_2)/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)) + self.tau_3)/(I_3 + l_3**2*m_3/4 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2) - (I_3 + m_3*(l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_3 + m_3*(l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)*(I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2))**2/(I_2 + I_3 + l_2**2*m_2/4 + m_3*(2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2 - (I_2 + I_3 + m_2*(l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1*l_2*np.cos(theta_2) + l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)**2/(I_1 + I_2 + I_3 + l_1**2*m_1/4 + m_2*(2*l_1**2 + 2*l_1*l_2*np.cos(theta_2) + l_2**2/2)/2 + m_3*(2*l_1**2 + 4*l_1*l_2*np.cos(theta_2) + 2*l_1*l_3*(-np.sin(theta_2)*np.sin(theta_3) + np.cos(theta_2)*np.cos(theta_3)) + 2*l_2**2 + 2*l_2*l_3*np.cos(theta_3) + l_3**2/2)/2)))]